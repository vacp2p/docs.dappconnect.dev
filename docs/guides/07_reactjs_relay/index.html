<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Receive and Send Messages Using Waku Relay With ReactJS #  It is easy to use Waku Connect with ReactJS. In this guide, we will demonstrate how your ReactJS dApp can use Waku Relay to send and receive messages.
Before starting, you need to choose a Content Topic for your dApp. Check out the how to choose a content topic guide to learn more about content topics. For this guide, we are using a single content topic: /min-react-js-chat/1/chat/proto.">
<meta name="theme-color" content="#FFFFFF">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="Receive and Send Messages Using Waku Relay With ReactJS" />
<meta property="og:description" content="Receive and Send Messages Using Waku Relay With ReactJS #  It is easy to use Waku Connect with ReactJS. In this guide, we will demonstrate how your ReactJS dApp can use Waku Relay to send and receive messages.
Before starting, you need to choose a Content Topic for your dApp. Check out the how to choose a content topic guide to learn more about content topics. For this guide, we are using a single content topic: /min-react-js-chat/1/chat/proto." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://js.waku.guide/docs/guides/07_reactjs_relay/" /><meta property="article:section" content="docs" />
<meta property="article:published_time" content="2021-12-09T14:00:00+01:00" />
<meta property="article:modified_time" content="2022-04-11T17:21:17+01:00" />

<title>Receive and Send Messages Using Waku Relay With ReactJS | Waku Connect Docs</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" type="image/x-icon">
<link rel="stylesheet" href="/book.min.89a77f7e702a8626749b948bbfb01109823daf6c1246ca407d1378833494c402.css" integrity="sha256-iad/fnAqhiZ0m5SLv7ARCYI9r2wSRspAfRN4gzSUxAI=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.2be1dec4d66fbe768a17b3ec4a7c6fef4e620dfa2305fa0067e3da6f1bd3bb25.js" integrity="sha256-K&#43;HexNZvvnaKF7PsSnxv705iDfojBfoAZ&#43;PabxvTuyU=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
<script>
    (function (f, a, t, h, o, m) {
        a[h] = a[h] || function () {
            (a[h].q = a[h].q || []).push(arguments)
        };
        o = f.createElement('script');
        m = f.getElementsByTagName('script')[0];
        o.async = 1;
        o.src = t;
        o.id = 'fathom-script';
        m.parentNode.insertBefore(o, m)
    })(document, window, '//fathom.status.im/tracker.js', 'fathom');
    fathom('set', 'siteId', 'BBYCC');
    fathom('trackPageview');
</script>


</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Waku Connect Docs</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/introduction/" class="">Introduction</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/quick_start/" class="">Quick Start</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/faq/" class="">FAQ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/use_cases/" class="">Use Cases</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/presentations/" class="">Presentations &amp; Videos</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/" class="">Guides</a>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/01_choose_content_topic/" class="">How to Choose a Content Topic</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/discovery_bootstrap/" class="">Discovery &amp; Bootstrap Nodes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/02_relay_receive_send_messages/" class="">Receive and Send Messages Using Waku Relay</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/03_store_retrieve_messages/" class="">Retrieve Messages Using Waku Store</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/04_encrypt_messages_version_1/" class="">Encrypt Messages Using Waku Message Version 1</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/sign_messages_web3_eip712/" class="">Sign Messages Using a Web3 Wallet (EIP-712)</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/05_sign_messages_version_1/" class="">Sign Messages Using Waku Message Version 1</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/06_light_push_send_messages/" class="">Send Messages Using Waku Light Push</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/07_reactjs_relay/" class=" active">Receive and Send Messages Using Waku Relay With ReactJS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/08_reactjs_store/" class="">Retrieve Messages Using Waku Store With ReactJS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/angular_relay/" class="">Send and Receive Messages Using Waku Relay With Angular v13</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/nwaku/" class="">Nwaku Service Node</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/guides/debug/" class="">How to Debug your Waku dApp</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/examples/" class="">Examples</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/crypto_libraries/" class="">Cryptographic Libraries</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="https://js.waku.guide/docs/waku_protocols/" class="">Implemented Waku Protocols</a>
  

        </li>
      
    
  </ul>











  
<ul>
  
  <li>
    <a href="https://js.waku.org/" target="_blank" rel="noopener">
        JS-Waku API Doc
      </a>
  </li>
  
  <li>
    <a href="https://vac.dev/" target="_blank" rel="noopener">
        Vac
      </a>
  </li>
  
  <li>
    <a href="https://rfc.vac.dev/" target="_blank" rel="noopener">
        Vac RFCs
      </a>
  </li>
  
  <li>
    <a href="https://status.im/" target="_blank" rel="noopener">
        Status.im
      </a>
  </li>
  
</ul>






</nav>




  <script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Receive and Send Messages Using Waku Relay With ReactJS</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#receive-and-send-messages-using-waku-relay-with-reactjs">Receive and Send Messages Using Waku Relay With ReactJS</a></li>
    <li><a href="#setup">Setup</a>
      <ul>
        <li><a href="#bigint"><code>BigInt</code></a></li>
        <li><a href="#setup-polyfills">Setup polyfills</a>
          <ul>
            <li><a href="#webpack-5">Webpack 5</a></li>
            <li><a href="#cra-webpack-rewired">cra-webpack-rewired</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#create-waku-instance">Create Waku Instance</a></li>
    <li><a href="#wait-to-be-connected">Wait to be connected</a></li>
    <li><a href="#define-message-format">Define Message Format</a></li>
    <li><a href="#send-messages">Send Messages</a></li>
    <li><a href="#receive-messages">Receive Messages</a></li>
    <li><a href="#display-messages">Display Messages</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown"><h1 id="receive-and-send-messages-using-waku-relay-with-reactjs">
  Receive and Send Messages Using Waku Relay With ReactJS
  <a class="anchor" href="#receive-and-send-messages-using-waku-relay-with-reactjs">#</a>
</h1>
<p>It is easy to use Waku Connect with ReactJS.
In this guide, we will demonstrate how your ReactJS dApp can use Waku Relay to send and receive messages.</p>
<p>Before starting, you need to choose a <em>Content Topic</em> for your dApp.
Check out the <a href="/docs/guides/01_choose_content_topic/">how to choose a content topic guide</a> to learn more about content topics.
For this guide, we are using a single content topic: <code>/min-react-js-chat/1/chat/proto</code>.</p>
<h1 id="setup">
  Setup
  <a class="anchor" href="#setup">#</a>
</h1>
<p>Create a new React app:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">npx create-react-app relay-reactjs-chat
cd relay-reactjs-chat
</code></pre></div><h2 id="bigint">
  <code>BigInt</code>
  <a class="anchor" href="#bigint">#</a>
</h2>
<p>Some of js-waku&rsquo;s dependencies use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt"><code>BigInt</code></a>
that is <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt#browser_compatibility">only supported by modern browsers</a>.</p>
<p>To ensure that <code>react-scripts</code> properly transpile your webapp code, update the <code>package.json</code> file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-json" data-lang="json">{
  <span style="color:#f92672">&#34;browserslist&#34;</span>: {
    <span style="color:#f92672">&#34;production&#34;</span>: [
      <span style="color:#e6db74">&#34;&gt;0.2%&#34;</span>,
      <span style="color:#e6db74">&#34;not ie &lt;= 99&#34;</span>,
      <span style="color:#e6db74">&#34;not android &lt;= 4.4.4&#34;</span>,
      <span style="color:#e6db74">&#34;not dead&#34;</span>,
      <span style="color:#e6db74">&#34;not op_mini all&#34;</span>
    ]
  }
}
</code></pre></div><h2 id="setup-polyfills">
  Setup polyfills
  <a class="anchor" href="#setup-polyfills">#</a>
</h2>
<p>A number of Web3 dependencies need polyfills.
Said polyfills must be explicitly declared when using webpack 5.</p>
<p>The latest <code>react-scripts</code> version uses webpack 5.</p>
<p>We will describe below a method to configure polyfills when using <code>create-react-app</code>/<code>react-scripts</code> or webpack 5.
This may not be necessary if you do not use <code>react-scripts</code> or if you use webpack 4.</p>
<p>Start by installing the polyfill libraries:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">npm install --save assert buffer crypto-browserify process stream-browserify
</code></pre></div><h3 id="webpack-5">
  Webpack 5
  <a class="anchor" href="#webpack-5">#</a>
</h3>
<p>If you directly use webpack 5,
then you can inspire yourself from this <a href="https://github.com/status-im/wakuconnect-vote-poll-sdk/blob/main/examples/mainnet-poll/webpack.config.js">webpack.config.js</a>.</p>
<h3 id="cra-webpack-rewired">
  cra-webpack-rewired
  <a class="anchor" href="#cra-webpack-rewired">#</a>
</h3>
<p>An alternative is to let <code>react-scripts</code> control the webpack 5 config and only override some elements using <code>cra-webpack-rewired</code>.</p>
<p>Install <code>cra-webpack-rewired</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">npm install -D cra-webpack-rewired
</code></pre></div><p>Create a <code>config/webpack.extend.js</code> file at the root of your app:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">webpack</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;webpack&#34;</span>);

<span style="color:#a6e22e">module</span>.<span style="color:#a6e22e">exports</span> <span style="color:#f92672">=</span> {
  <span style="color:#a6e22e">dev</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">config</span>) =&gt; {
    <span style="color:#75715e">// Override webpack 5 config from react-scripts to load polyfills
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">resolve</span>) <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">resolve</span> <span style="color:#f92672">=</span> {};
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">resolve</span>.<span style="color:#a6e22e">fallback</span>) <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">resolve</span>.<span style="color:#a6e22e">fallback</span> <span style="color:#f92672">=</span> {};
    Object.<span style="color:#a6e22e">assign</span>(<span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">resolve</span>.<span style="color:#a6e22e">fallback</span>, {
      <span style="color:#a6e22e">buffer</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">require</span>.<span style="color:#a6e22e">resolve</span>(<span style="color:#e6db74">&#34;buffer&#34;</span>),
      <span style="color:#a6e22e">crypto</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">require</span>.<span style="color:#a6e22e">resolve</span>(<span style="color:#e6db74">&#34;crypto-browserify&#34;</span>),
      <span style="color:#a6e22e">stream</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">require</span>.<span style="color:#a6e22e">resolve</span>(<span style="color:#e6db74">&#34;stream-browserify&#34;</span>),
    });

    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">plugins</span>) <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">plugins</span> <span style="color:#f92672">=</span> [];
    <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">plugins</span>.<span style="color:#a6e22e">push</span>(
      <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">webpack</span>.<span style="color:#a6e22e">DefinePlugin</span>({
        <span style="color:#e6db74">&#34;process.env.ENV&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#e6db74">&#34;dev&#34;</span>),
      })
    );
    <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">plugins</span>.<span style="color:#a6e22e">push</span>(
      <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">webpack</span>.<span style="color:#a6e22e">ProvidePlugin</span>({
        <span style="color:#a6e22e">process</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;process/browser.js&#34;</span>,
        <span style="color:#a6e22e">Buffer</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;buffer&#34;</span>, <span style="color:#e6db74">&#34;Buffer&#34;</span>],
      })
    );

    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">ignoreWarnings</span>) <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">ignoreWarnings</span> <span style="color:#f92672">=</span> [];
    <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">ignoreWarnings</span>.<span style="color:#a6e22e">push</span>(<span style="color:#e6db74">/Failed to parse source map/</span>);

    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">config</span>;
  },
  <span style="color:#a6e22e">prod</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">config</span>) =&gt; {
    <span style="color:#75715e">// Override webpack 5 config from react-scripts to load polyfills
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">resolve</span>) <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">resolve</span> <span style="color:#f92672">=</span> {};
    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">resolve</span>.<span style="color:#a6e22e">fallback</span>) <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">resolve</span>.<span style="color:#a6e22e">fallback</span> <span style="color:#f92672">=</span> {};
    Object.<span style="color:#a6e22e">assign</span>(<span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">resolve</span>.<span style="color:#a6e22e">fallback</span>, {
      <span style="color:#a6e22e">buffer</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">require</span>.<span style="color:#a6e22e">resolve</span>(<span style="color:#e6db74">&#34;buffer&#34;</span>),
      <span style="color:#a6e22e">crypto</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">require</span>.<span style="color:#a6e22e">resolve</span>(<span style="color:#e6db74">&#34;crypto-browserify&#34;</span>),
      <span style="color:#a6e22e">stream</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">require</span>.<span style="color:#a6e22e">resolve</span>(<span style="color:#e6db74">&#34;stream-browserify&#34;</span>),
    });

    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">plugins</span>) <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">plugins</span> <span style="color:#f92672">=</span> [];
    <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">plugins</span>.<span style="color:#a6e22e">push</span>(
      <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">webpack</span>.<span style="color:#a6e22e">DefinePlugin</span>({
        <span style="color:#e6db74">&#34;process.env.ENV&#34;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#e6db74">&#34;prod&#34;</span>),
      })
    );
    <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">plugins</span>.<span style="color:#a6e22e">push</span>(
      <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">webpack</span>.<span style="color:#a6e22e">ProvidePlugin</span>({
        <span style="color:#a6e22e">process</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;process/browser.js&#34;</span>,
        <span style="color:#a6e22e">Buffer</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;buffer&#34;</span>, <span style="color:#e6db74">&#34;Buffer&#34;</span>],
      })
    );

    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">ignoreWarnings</span>) <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">ignoreWarnings</span> <span style="color:#f92672">=</span> [];
    <span style="color:#a6e22e">config</span>.<span style="color:#a6e22e">ignoreWarnings</span>.<span style="color:#a6e22e">push</span>(<span style="color:#e6db74">/Failed to parse source map/</span>);

    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">config</span>;
  },
};
</code></pre></div><p>Use <code>cra-webpack-rewired</code> in the <code>package.json</code>, instead of <code>react-scripts</code>:</p>
<pre tabindex="0"><code>   &quot;scripts&quot;: {
-    &quot;start&quot;: &quot;react-scripts start&quot;,
-    &quot;build&quot;: &quot;react-scripts build&quot;,
-    &quot;test&quot;: &quot;react-scripts test&quot;,
-    &quot;eject&quot;: &quot;react-scripts eject&quot;
+    &quot;start&quot;: &quot;cra-webpack-rewired start&quot;,
+    &quot;build&quot;: &quot;cra-webpack-rewired build&quot;,
+    &quot;test&quot;: &quot;cra-webpack-rewired test&quot;,
+    &quot;eject&quot;: &quot;cra-webpack-rewired eject&quot;
   },
</code></pre><p>Then, install <a href="https://npmjs.com/package/js-waku">js-waku</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">npm install --save js-waku
</code></pre></div><p>Start the dev server and open the dApp in your browser:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">npm run start
</code></pre></div><h1 id="create-waku-instance">
  Create Waku Instance
  <a class="anchor" href="#create-waku-instance">#</a>
</h1>
<p>In order to interact with the Waku network, you first need a Waku instance.
Go to <code>App.js</code> and modify the <code>App</code> function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">Waku</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;js-waku&#34;</span>;
<span style="color:#66d9ef">import</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">as</span> <span style="color:#a6e22e">React</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;react&#34;</span>;

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">App</span>() {
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">waku</span>, <span style="color:#a6e22e">setWaku</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useState</span>(<span style="color:#66d9ef">undefined</span>);
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">wakuStatus</span>, <span style="color:#a6e22e">setWakuStatus</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#34;None&#34;</span>);

  <span style="color:#75715e">// Start Waku
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useEffect</span>(() =&gt; {
    <span style="color:#75715e">// If Waku is already assigned, the job is done
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!!</span><span style="color:#a6e22e">waku</span>) <span style="color:#66d9ef">return</span>;
    <span style="color:#75715e">// If Waku status not None, it means we are already starting Waku
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">wakuStatus</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#34;None&#34;</span>) <span style="color:#66d9ef">return</span>;

    <span style="color:#a6e22e">setWakuStatus</span>(<span style="color:#e6db74">&#34;Starting&#34;</span>);

    <span style="color:#75715e">// Create Waku
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">Waku</span>.<span style="color:#a6e22e">create</span>({ <span style="color:#a6e22e">bootstrap</span><span style="color:#f92672">:</span> { <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> } }).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">waku</span>) =&gt; {
      <span style="color:#75715e">// Once done, put it in the state
</span><span style="color:#75715e"></span>      <span style="color:#a6e22e">setWaku</span>(<span style="color:#a6e22e">waku</span>);
      <span style="color:#75715e">// And update the status
</span><span style="color:#75715e"></span>      <span style="color:#a6e22e">setWakuStatus</span>(<span style="color:#e6db74">&#34;Started&#34;</span>);
    });
  }, [<span style="color:#a6e22e">waku</span>, <span style="color:#a6e22e">wakuStatus</span>]);

  <span style="color:#66d9ef">return</span> (
    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;App&#34;</span><span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">header</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;App-header&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">Waku</span> <span style="color:#a6e22e">node</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">s</span> <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> {<span style="color:#a6e22e">wakuStatus</span>}<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/p&gt;</span>
      <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/header&gt;</span>
    <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
  );
}

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#a6e22e">App</span>;
</code></pre></div><h1 id="wait-to-be-connected">
  Wait to be connected
  <a class="anchor" href="#wait-to-be-connected">#</a>
</h1>
<p>When using the <code>bootstrap</code> option, it may take some time to connect to other peers.
To ensure that you have relay peers available to send and receive messages,
use the <code>Waku.waitForRemotePeer()</code> async function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useEffect</span>(() =&gt; {
  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!!</span><span style="color:#a6e22e">waku</span>) <span style="color:#66d9ef">return</span>;
  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">wakuStatus</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#34;None&#34;</span>) <span style="color:#66d9ef">return</span>;

  <span style="color:#a6e22e">setWakuStatus</span>(<span style="color:#e6db74">&#34;Starting&#34;</span>);

  <span style="color:#a6e22e">Waku</span>.<span style="color:#a6e22e">create</span>({ <span style="color:#a6e22e">bootstrap</span><span style="color:#f92672">:</span> { <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span> } }).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">waku</span>) =&gt; {
    <span style="color:#a6e22e">setWaku</span>(<span style="color:#a6e22e">waku</span>);
    <span style="color:#a6e22e">setWakuStatus</span>(<span style="color:#e6db74">&#34;Connecting&#34;</span>);
    <span style="color:#a6e22e">waku</span>.<span style="color:#a6e22e">waitForRemotePeer</span>().<span style="color:#a6e22e">then</span>(() =&gt; {
      <span style="color:#a6e22e">setWakuStatus</span>(<span style="color:#e6db74">&#34;Ready&#34;</span>);
    });
  });
}, [<span style="color:#a6e22e">waku</span>, <span style="color:#a6e22e">wakuStatus</span>]);
</code></pre></div><h1 id="define-message-format">
  Define Message Format
  <a class="anchor" href="#define-message-format">#</a>
</h1>
<p>To define the Protobuf message format,
you can use <a href="https://www.npmjs.com/package/protobufjs">protobufjs</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">npm install protobufjs
</code></pre></div><p>Define <code>SimpleChatMessage</code> with two fields: <code>timestamp</code> and <code>text</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">protobuf</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;protobufjs&#34;</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">SimpleChatMessage</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">protobuf</span>.<span style="color:#a6e22e">Type</span>(<span style="color:#e6db74">&#34;SimpleChatMessage&#34;</span>)
    .<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">protobuf</span>.<span style="color:#a6e22e">Field</span>(<span style="color:#e6db74">&#34;timestamp&#34;</span>, <span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;uint64&#34;</span>))
    .<span style="color:#a6e22e">add</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">protobuf</span>.<span style="color:#a6e22e">Field</span>(<span style="color:#e6db74">&#34;text&#34;</span>, <span style="color:#ae81ff">2</span>, <span style="color:#e6db74">&#34;string&#34;</span>));
</code></pre></div><h1 id="send-messages">
  Send Messages
  <a class="anchor" href="#send-messages">#</a>
</h1>
<p>Create a function that takes the Waku instance and a message to send:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">import</span> {<span style="color:#a6e22e">WakuMessage</span>} <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;js-waku&#34;</span>;

<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">ContentTopic</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`/relay-reactjs-chat/1/chat/proto`</span>;

<span style="color:#66d9ef">function</span> <span style="color:#a6e22e">sendMessage</span>(<span style="color:#a6e22e">message</span>, <span style="color:#a6e22e">waku</span>, <span style="color:#a6e22e">timestamp</span>) {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">time</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">timestamp</span>.<span style="color:#a6e22e">getTime</span>();

    <span style="color:#75715e">// Encode to protobuf
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">protoMsg</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SimpleChatMessage</span>.<span style="color:#a6e22e">create</span>({
        <span style="color:#a6e22e">timestamp</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">time</span>,
        <span style="color:#a6e22e">text</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">message</span>,
    });
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">payload</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">SimpleChatMessage</span>.<span style="color:#a6e22e">encode</span>(<span style="color:#a6e22e">protoMsg</span>).<span style="color:#a6e22e">finish</span>();

    <span style="color:#75715e">// Wrap in a Waku Message
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">WakuMessage</span>.<span style="color:#a6e22e">fromBytes</span>(<span style="color:#a6e22e">payload</span>, <span style="color:#a6e22e">ContentTopic</span>).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">wakuMessage</span>) =&gt;
        <span style="color:#75715e">// Send over Waku Relay
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">waku</span>.<span style="color:#a6e22e">relay</span>.<span style="color:#a6e22e">send</span>(<span style="color:#a6e22e">wakuMessage</span>)
    );
}
</code></pre></div><p>Then, add a button to the <code>App</code> function:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">App</span>() {
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">waku</span>, <span style="color:#a6e22e">setWaku</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useState</span>(<span style="color:#66d9ef">undefined</span>);
  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">wakuStatus</span>, <span style="color:#a6e22e">setWakuStatus</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useState</span>(<span style="color:#e6db74">&#34;None&#34;</span>);
  <span style="color:#75715e">// Using a counter just for the messages to be different
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">sendCounter</span>, <span style="color:#a6e22e">setSendCounter</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useState</span>(<span style="color:#ae81ff">0</span>);

  <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useEffect</span>(() =&gt; {
    <span style="color:#75715e">// ... creates Waku
</span><span style="color:#75715e"></span>  }, [<span style="color:#a6e22e">waku</span>, <span style="color:#a6e22e">wakuStatus</span>]);

  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">sendMessageOnClick</span> <span style="color:#f92672">=</span> () =&gt; {
    <span style="color:#75715e">// Check Waku is started and connected first.
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">wakuStatus</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#34;Ready&#34;</span>) <span style="color:#66d9ef">return</span>;

    <span style="color:#a6e22e">sendMessage</span>(<span style="color:#e6db74">`Here is message #</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">sendCounter</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>, <span style="color:#a6e22e">waku</span>, <span style="color:#66d9ef">new</span> Date()).<span style="color:#a6e22e">then</span>(() =&gt;
      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;Message sent&#34;</span>)
    );

    <span style="color:#75715e">// For demonstration purposes.
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">setSendCounter</span>(<span style="color:#a6e22e">sendCounter</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span>);
  };

  <span style="color:#66d9ef">return</span> (
    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;App&#34;</span><span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">header</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;App-header&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span><span style="color:#f92672">&gt;</span>{<span style="color:#a6e22e">wakuStatus</span>}<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/p&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">button</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">sendMessageOnClick</span>} <span style="color:#a6e22e">disabled</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">wakuStatus</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#34;Ready&#34;</span>}<span style="color:#f92672">&gt;</span>
          <span style="color:#a6e22e">Send</span> <span style="color:#a6e22e">Message</span>
        <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/button&gt;</span>
      <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/header&gt;</span>
    <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
  );
}
</code></pre></div><h1 id="receive-messages">
  Receive Messages
  <a class="anchor" href="#receive-messages">#</a>
</h1>
<p>To process incoming messages, you need to register an observer on Waku Relay.
First, you need to define the observer function.</p>
<p>You will need to remove the observer when the component unmount.
Hence, you need the reference to the function to remain the same.
For that, use <code>React.useCallback</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">processIncomingMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useCallback</span>((<span style="color:#a6e22e">wakuMessage</span>) =&gt; {
    <span style="color:#75715e">// Empty message?
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">wakuMessage</span>.<span style="color:#a6e22e">payload</span>) <span style="color:#66d9ef">return</span>;

    <span style="color:#75715e">// Decode the protobuf payload
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">const</span> {<span style="color:#a6e22e">text</span>, <span style="color:#a6e22e">timestamp</span>} <span style="color:#f92672">=</span> <span style="color:#a6e22e">SimpleChatMessage</span>.<span style="color:#a6e22e">decode</span>(<span style="color:#a6e22e">wakuMessage</span>.<span style="color:#a6e22e">payload</span>);

    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">time</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date();
    <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">setTime</span>(<span style="color:#a6e22e">timestamp</span>);

    <span style="color:#75715e">// For now, just log new messages on the console
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`message received at </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">toString</span>()<span style="color:#e6db74">}</span><span style="color:#e6db74">: </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">text</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
}, []);
</code></pre></div><p>Then, add this observer to Waku Relay.
Do not forget to delete the observer is the component is being unmounted:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useEffect</span>(() =&gt; {
  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">waku</span>) <span style="color:#66d9ef">return</span>;

  <span style="color:#75715e">// Pass the content topic to only process messages related to your dApp
</span><span style="color:#75715e"></span>  <span style="color:#a6e22e">waku</span>.<span style="color:#a6e22e">relay</span>.<span style="color:#a6e22e">addObserver</span>(<span style="color:#a6e22e">processIncomingMessage</span>, [<span style="color:#a6e22e">ContentTopic</span>]);

  <span style="color:#75715e">// `cleanUp` is called when the component is unmounted, see ReactJS doc.
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">cleanUp</span>() {
    <span style="color:#a6e22e">waku</span>.<span style="color:#a6e22e">relay</span>.<span style="color:#a6e22e">deleteObserver</span>(<span style="color:#a6e22e">processIncomingMessage</span>, [<span style="color:#a6e22e">ContentTopic</span>]);
  };
}, [<span style="color:#a6e22e">waku</span>, <span style="color:#a6e22e">wakuStatus</span>, <span style="color:#a6e22e">processIncomingMessage</span>]);
</code></pre></div><h1 id="display-messages">
  Display Messages
  <a class="anchor" href="#display-messages">#</a>
</h1>
<p>The Waku work is now done.
Your dApp is able to send and receive messages using Waku.
For the sake of completeness, let&rsquo;s display received messages on the page.</p>
<p>First, add incoming messages to the state of the <code>App</code> component:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">App</span>() {
    <span style="color:#75715e">//...
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">const</span> [<span style="color:#a6e22e">messages</span>, <span style="color:#a6e22e">setMessages</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useState</span>([]);

    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">processIncomingMessage</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">React</span>.<span style="color:#a6e22e">useCallback</span>((<span style="color:#a6e22e">wakuMessage</span>) =&gt; {
        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">wakuMessage</span>.<span style="color:#a6e22e">payload</span>) <span style="color:#66d9ef">return</span>;

        <span style="color:#66d9ef">const</span> {<span style="color:#a6e22e">text</span>, <span style="color:#a6e22e">timestamp</span>} <span style="color:#f92672">=</span> <span style="color:#a6e22e">SimpleChatMessage</span>.<span style="color:#a6e22e">decode</span>(<span style="color:#a6e22e">wakuMessage</span>.<span style="color:#a6e22e">payload</span>);

        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">time</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Date();
        <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">setTime</span>(<span style="color:#a6e22e">timestamp</span>);
        <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">message</span> <span style="color:#f92672">=</span> {<span style="color:#a6e22e">text</span>, <span style="color:#a6e22e">timestamp</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">time</span>};

        <span style="color:#a6e22e">setMessages</span>((<span style="color:#a6e22e">messages</span>) =&gt; {
            <span style="color:#66d9ef">return</span> [<span style="color:#a6e22e">message</span>].<span style="color:#a6e22e">concat</span>(<span style="color:#a6e22e">messages</span>);
        });
    }, []);

    <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>}
</code></pre></div><p>Then, render the messages:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#66d9ef">function</span> <span style="color:#a6e22e">App</span>() {
  <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>
  <span style="color:#66d9ef">return</span> (
    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;App&#34;</span><span style="color:#f92672">&gt;</span>
      <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">header</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;App-header&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span><span style="color:#f92672">&gt;</span>{<span style="color:#a6e22e">wakuStatus</span>}<span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/p&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">button</span> <span style="color:#a6e22e">onClick</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">sendMessageOnClick</span>} <span style="color:#a6e22e">disabled</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">wakuStatus</span> <span style="color:#f92672">!==</span> <span style="color:#e6db74">&#34;Ready&#34;</span>}<span style="color:#f92672">&gt;</span>
          <span style="color:#a6e22e">Send</span> <span style="color:#a6e22e">Message</span>
        <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/button&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">ul</span><span style="color:#f92672">&gt;</span>
          {<span style="color:#a6e22e">messages</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">msg</span>) =&gt; {
            <span style="color:#66d9ef">return</span> (
              <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">li</span><span style="color:#f92672">&gt;</span>
                <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">p</span><span style="color:#f92672">&gt;</span>
                  {<span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">timestamp</span>.<span style="color:#a6e22e">toString</span>()}<span style="color:#f92672">:</span> {<span style="color:#a6e22e">msg</span>.<span style="color:#a6e22e">text</span>}
                <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/p&gt;</span>
              <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/li&gt;</span>
            );
          })}
        <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/ul&gt;</span>
      <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/header&gt;</span>
    <span style="color:#f92672">&lt;</span><span style="color:#960050;background-color:#1e0010">/div&gt;</span>
  );
}
</code></pre></div><p>And Voilà! You should now be able to send and receive messages.
Try out by opening the app from different browsers.</p>
<p>You can see the complete code in the <a href="https://github.com/status-im/js-waku/tree/main/examples/relay-reactjs-chat">Relay ReactJS Chat Example App</a>.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">


  <div><a class="flex align-center" href="https://github.com/waku-org/js.waku.guide/commit/7b5b21837089f8268878550200c77491d478b944" title='Last modified by jemboh | Apr 11, 2022' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" class="book-icon" alt="Calendar" />
      <span>Apr 11, 2022</span>
    </a>
  </div>



  <div>
    <a class="flex align-center" href="https://github.com/waku-org/js.waku.guide/edit/develop/content/docs/guides/07_reactjs_relay.md" target="_blank" rel="noopener">
      <img src="/svg/edit.svg" class="book-icon" alt="Edit" />
      <span>Edit this page</span>
    </a>
  </div>


</div>



  <script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#receive-and-send-messages-using-waku-relay-with-reactjs">Receive and Send Messages Using Waku Relay With ReactJS</a></li>
    <li><a href="#setup">Setup</a>
      <ul>
        <li><a href="#bigint"><code>BigInt</code></a></li>
        <li><a href="#setup-polyfills">Setup polyfills</a>
          <ul>
            <li><a href="#webpack-5">Webpack 5</a></li>
            <li><a href="#cra-webpack-rewired">cra-webpack-rewired</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#create-waku-instance">Create Waku Instance</a></li>
    <li><a href="#wait-to-be-connected">Wait to be connected</a></li>
    <li><a href="#define-message-format">Define Message Format</a></li>
    <li><a href="#send-messages">Send Messages</a></li>
    <li><a href="#receive-messages">Receive Messages</a></li>
    <li><a href="#display-messages">Display Messages</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












